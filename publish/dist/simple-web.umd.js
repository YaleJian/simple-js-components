!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).simpleWeb=t()}(this,(function(){"use strict";var e={isArray:e=>Array.isArray(e),isObject:e=>"[object Object]"===Object.prototype.toString.call(e),isPromise:e=>"[object Promise]"===Object.prototype.toString.call(e),isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};const t={getType:e=>null==e?String(e):Object.prototype.toString.call(e).match(/\[object (\w+)]/)[1].toLowerCase(),clone:e=>JSON.parse(JSON.stringify(e)),merge(){let n,o,s,i,r,a,c=(arguments.length<=0?void 0:arguments[0])||{},l=1,d=arguments.length;for(1===d&&(c=this,l=0);l<d;l++)if(n=l<0||arguments.length<=l?void 0:arguments[l],n)for(o in n)i=n[o],"_proto_"!==o&&c[o]!==i&&(i&&(e.isObject(i)||(r=e.isArray(i)))?(s=c[o],a=r&&!e.isArray(s)?[]:r||e.isObject(s)?s:{},r=!1,c[o]=t.merge(a,i)):void 0!==i&&(c[o]=i));return c}};window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("config")}catch(e){window.Event=function(e,t,n,o){let s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t,n,o),s}}let n={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},o="readystatechange loadstart progress abort error load timeout loadend".split(" "),s="timeout withCredentials".split(" "),i="readyState responseURL status statusText responseType response responseText responseXML".split(" "),r={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function a(){this.config={events:{},headers:{}},this.proxy=!1,this.debug=!1}t.merge(a,n),t.merge(a.prototype,n),a.prototype.mock=!0,a.prototype.noProxy=!1,t.merge(a.prototype,{open:function(e,n,r,c,l){let d=this;function h(e){for(let t=0;t<i.length;t++)try{d[i[t]]=xhr[i[t]]}catch(e){}d.dispatchEvent(new Event(e.type))}if(t.merge(this.config,{method:e,url:n,async:"boolean"!=typeof r||r,username:c,password:l,body:"",options:{url:n,method:e}}),this.noProxy||this.proxy){let t=function(){let e=function(){let e=location.href,t=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/.exec(e.toLowerCase())||[];return/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(t[1])}();return window.ActiveXObject?!e&&t()||function(){try{return new window._ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}():t();function t(){try{return new window._XMLHttpRequest}catch(e){}}}();this.config.xhr=t;for(let e=0;e<o.length;e++)t.addEventListener(o[e],h);c?t.open(e,n,r,c,l):t.open(e,n,r);for(let n=0;n<s.length;n++)try{t[s[n]]=d[s[n]]}catch(e){}}else this.readyState=a.OPENED,this.dispatchEvent(new Event("readystatechange"))},setRequestHeader:function(e,t){if(this.noProxy||this.proxy)return void this.config.xhr.setRequestHeader(e,t);let n=this.config.headers;n[e]?n[e]+=","+t:n[e]=t},timeout:0,withCredentials:!1,upload:{},send:function(t){let n=this;if(this.config.body=t,this.config.timeout=this.timeout,this.noProxy||this.proxy)this.config.xhr.send(t);else if(this.setRequestHeader("X-Requested-With","MockXHR"),this.dispatchEvent(new Event("loadstart")),n.readyState=a.HEADERS_RECEIVED,n.dispatchEvent(new Event("readystatechange")),n.readyState=a.LOADING,n.dispatchEvent(new Event("readystatechange")),a.proxy){a.debug&&console.log("[XHR] 请求xhr:",n.config);let t=a.proxy(n);e.isPromise(t)&&t.then((e=>{o(e)})).catch((e=>{o(e)}))}else console.warn("[tools-xhr] proxy param is not a Promise");function o(e,t){a.debug&&console.log("[XHR] 响应data:",e),e.responseHeaders&&(n.responseHeaders=e.responseHeaders),e.response&&(n.response=e.response||""),"string"==typeof e.response&&(n.responseText=e.response),e.responseType&&(n.responseType=e.responseType),e.responseURL&&(n.responseURL=e.responseURL),e.responseXML&&(n.responseXML=e.responseXML),n.status=e.status||200,n.statusText=e.statusText||r[n.status],e.timeout&&(n.timeout=e.timeout),e.withCredentials&&(n.withCredentials=e.withCredentials),n.readyState=a.DONE,n.dispatchEvent(new Event("readystatechange")),n.dispatchEvent(new Event("load")),n.dispatchEvent(new Event("loadend"))}},abort:function(){this.noProxy?this.config.xhr.abort():(this.readyState=a.UNSENT,this.dispatchEvent(new Event("abort",!1,!1,this)),this.dispatchEvent(new Event("error",!1,!1,this)))}}),t.merge(a.prototype,{status:a.UNSENT,statusText:"",getResponseHeader:function(e){return this.noProxy||this.proxy?this.config.xhr.getResponseHeader(e):this.responseHeaders[e.toLowerCase()]},getAllResponseHeaders:function(){if(this.noProxy||this.proxy)return this.config.xhr.getAllResponseHeaders();let e=this.responseHeaders,t="";for(let n in e)e.hasOwnProperty(n)&&(t+=n+": "+e[n]+"\r\n");return t},overrideMimeType:function(){},responseHeaders:{},responseURL:"",responseType:"",response:null,responseText:"",responseXML:null}),t.merge(a.prototype,{addEventListener:function(e,t){let n=this.config.events;n[e]||(n[e]=[]),n[e].push(t)},removeEventListener:function(e,t){let n=this.config.events[e]||[];for(let e=0;e<n.length;e++)n[e]===t&&n.splice(e--,1)},dispatchEvent:function(e){let t=this.config.events[e.type]||[];for(let n=0;n<t.length;n++)t[n].call(this,e);let n="on"+e.type;this[n]&&this[n](e)}});let c=e;class l extends HTMLElement{get sync(){return this.getAttribute("sync")||!0}set sync(e){!1===e&&this.setAttribute("sync",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}}let d={init:e=>{d.hooks("toggleAttribute",!1,e),d.syncHook(!1,e)},HTMLElement:l,hooks(e,t,n){const o=n.prototype[e];o&&!o.hooked&&(n.prototype[e]=function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];let r=!!(s&&s.length>0)&&s[s.length-1];if(r&&c.isFunction(r)&&r.isHook&&(t=r),!(t&&c.isFunction(t)&&t.isHook))return console.log("[HTMLElement]",e,s),o.apply(this,arguments);t(arguments,this).then((t=>(arguments[s.length-1]=void 0,console.log("[HTMLElement hooks]",e,s),o.apply(this,arguments))))},n.prototype[e].hooked=!0)},syncHook(e,t){e||((e=(e,t)=>new Promise(((n,o)=>{!0!==t.sync&&"true"!==t.sync||d.syncAttr(t,e),n()}))).isHook=!0),d.hooks("attributeChangedCallback",e,t)},syncAttr(e,t){const n=t[0],o=t[1],s=t[2];if(e.shadowRoot.childNodes.length>0){let t=e.shadowRoot.childNodes;for(let e=0;e<t.length;e++){let e=t[0];s?e.setAttribute(n,s):e.toggleAttribute(n)}console.log("[HTMLElement syncAttr]",n,o,s)}},loadFont(e,t,n){let o=document.getElementsByTagName("head")[0],s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href="/simple-web/font/iconfont.css",o.appendChild(s);let i=document.createElement("script");i.src="/simple-web/font/iconfont.js",o.appendChild(i),console.log("loadFont")}};class h extends d.HTMLElement{constructor(){super()}get size(){return this.getAttribute("size")}set size(e){this.setAttribute("size",e)}toggleDisabled(e){this.syncChild=!0,e&&(e.isHook=!0),this.toggleAttribute("disabled",e)}}class p extends h{element;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML='<button class="button" part="button" id="button">\n                                    <slot></slot>\n                                </button>',this.element=e.getElementById("button")}static get observedAttributes(){return["disabled","size"]}attributeChangedCallback(e,t,n){}}class u extends h{element;constructor(e){super();const t=this.attachShadow({mode:"open"});t.innerHTML='<div class="icon iconfont" part="icon" id="icon">\n                                    <slot></slot>\n                                </div>';document.createElement("span").setAttribute("class","icon"),this.element=t.getElementById("icon")}static get observedAttributes(){return["disabled","size","name"]}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}get name(){this.getAttribute("name")}set name(e){this.setAttribute("name",e)}attributeChangedCallback(e,t,n){if(["name"].includes(e)){let e=document.createElement("svg");e.setAttribute("class","icon"),e.setAttribute("aria-hidden","true");let t=document.createElement("use");t.setAttribute("href",`#icon-${n}`),e.append(t),this.removeChild("shadowRoot"),this.prepend(e)}}}let y={button:{constructor:p,isHTMLTag:!0},icon:{constructor:u}};for(let e in y)y.hasOwnProperty(e)&&(d.init(y[e].constructor),customElements.get("s-"+e)||(console.log("s-"+e),customElements.define("s-"+e,y[e].constructor)));return d.loadFont(),{Button:p,Icon:u}}));