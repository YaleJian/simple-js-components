"use strict";var e={isArray:e=>Array.isArray(e),isObject:e=>"[object Object]"===Object.prototype.toString.call(e),isPromise:e=>"[object Promise]"===Object.prototype.toString.call(e),isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};const t={getType:e=>null==e?String(e):Object.prototype.toString.call(e).match(/\[object (\w+)]/)[1].toLowerCase(),clone:e=>JSON.parse(JSON.stringify(e)),merge(){let o,n,s,r,i,a,c=(arguments.length<=0?void 0:arguments[0])||{},l=1,d=arguments.length;for(1===d&&(c=this,l=0);l<d;l++)if(o=l<0||arguments.length<=l?void 0:arguments[l],o)for(n in o)r=o[n],"_proto_"!==n&&c[n]!==r&&(r&&(e.isObject(r)||(i=e.isArray(r)))?(s=c[n],a=i&&!e.isArray(s)?[]:i||e.isObject(s)?s:{},i=!1,c[n]=t.merge(a,r)):void 0!==r&&(c[n]=r));return c}};window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("config")}catch(e){window.Event=function(e,t,o,n){let s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t,o,n),s}}let o={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},n="readystatechange loadstart progress abort error load timeout loadend".split(" "),s="timeout withCredentials".split(" "),r="readyState responseURL status statusText responseType response responseText responseXML".split(" "),i={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function a(){this.config={events:{},headers:{}},this.proxy=!1,this.debug=!1}t.merge(a,o),t.merge(a.prototype,o),a.prototype.mock=!0,a.prototype.noProxy=!1,t.merge(a.prototype,{open:function(e,o,i,c,l){let d=this;function h(e){for(let t=0;t<r.length;t++)try{d[r[t]]=xhr[r[t]]}catch(e){}d.dispatchEvent(new Event(e.type))}if(t.merge(this.config,{method:e,url:o,async:"boolean"!=typeof i||i,username:c,password:l,body:"",options:{url:o,method:e}}),this.noProxy||this.proxy){let t=function(){let e=function(){let e=location.href,t=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/.exec(e.toLowerCase())||[];return/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(t[1])}();return window.ActiveXObject?!e&&t()||function(){try{return new window._ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}():t();function t(){try{return new window._XMLHttpRequest}catch(e){}}}();this.config.xhr=t;for(let e=0;e<n.length;e++)t.addEventListener(n[e],h);c?t.open(e,o,i,c,l):t.open(e,o,i);for(let o=0;o<s.length;o++)try{t[s[o]]=d[s[o]]}catch(e){}}else this.readyState=a.OPENED,this.dispatchEvent(new Event("readystatechange"))},setRequestHeader:function(e,t){if(this.noProxy||this.proxy)return void this.config.xhr.setRequestHeader(e,t);let o=this.config.headers;o[e]?o[e]+=","+t:o[e]=t},timeout:0,withCredentials:!1,upload:{},send:function(t){let o=this;if(this.config.body=t,this.config.timeout=this.timeout,this.noProxy||this.proxy)this.config.xhr.send(t);else if(this.setRequestHeader("X-Requested-With","MockXHR"),this.dispatchEvent(new Event("loadstart")),o.readyState=a.HEADERS_RECEIVED,o.dispatchEvent(new Event("readystatechange")),o.readyState=a.LOADING,o.dispatchEvent(new Event("readystatechange")),a.proxy){a.debug&&console.log("[XHR] 请求xhr:",o.config);let t=a.proxy(o);e.isPromise(t)&&t.then((e=>{n(e)})).catch((e=>{n(e)}))}else console.warn("[tools-xhr] proxy param is not a Promise");function n(e,t){a.debug&&console.log("[XHR] 响应data:",e),e.responseHeaders&&(o.responseHeaders=e.responseHeaders),e.response&&(o.response=e.response||""),"string"==typeof e.response&&(o.responseText=e.response),e.responseType&&(o.responseType=e.responseType),e.responseURL&&(o.responseURL=e.responseURL),e.responseXML&&(o.responseXML=e.responseXML),o.status=e.status||200,o.statusText=e.statusText||i[o.status],e.timeout&&(o.timeout=e.timeout),e.withCredentials&&(o.withCredentials=e.withCredentials),o.readyState=a.DONE,o.dispatchEvent(new Event("readystatechange")),o.dispatchEvent(new Event("load")),o.dispatchEvent(new Event("loadend"))}},abort:function(){this.noProxy?this.config.xhr.abort():(this.readyState=a.UNSENT,this.dispatchEvent(new Event("abort",!1,!1,this)),this.dispatchEvent(new Event("error",!1,!1,this)))}}),t.merge(a.prototype,{status:a.UNSENT,statusText:"",getResponseHeader:function(e){return this.noProxy||this.proxy?this.config.xhr.getResponseHeader(e):this.responseHeaders[e.toLowerCase()]},getAllResponseHeaders:function(){if(this.noProxy||this.proxy)return this.config.xhr.getAllResponseHeaders();let e=this.responseHeaders,t="";for(let o in e)e.hasOwnProperty(o)&&(t+=o+": "+e[o]+"\r\n");return t},overrideMimeType:function(){},responseHeaders:{},responseURL:"",responseType:"",response:null,responseText:"",responseXML:null}),t.merge(a.prototype,{addEventListener:function(e,t){let o=this.config.events;o[e]||(o[e]=[]),o[e].push(t)},removeEventListener:function(e,t){let o=this.config.events[e]||[];for(let e=0;e<o.length;e++)o[e]===t&&o.splice(e--,1)},dispatchEvent:function(e){let t=this.config.events[e.type]||[];for(let o=0;o<t.length;o++)t[o].call(this,e);let o="on"+e.type;this[o]&&this[o](e)}});let c=e;class l extends HTMLElement{get sync(){return this.getAttribute("sync")||!0}set sync(e){!1===e&&this.setAttribute("sync",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}}let d={init:e=>{d.hooks("toggleAttribute",!1,e),d.syncHook(!1,e)},HTMLElement:l,hooks(e,t,o){const n=o.prototype[e];n&&!n.hooked&&(o.prototype[e]=function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];let i=!!(s&&s.length>0)&&s[s.length-1];if(i&&c.isFunction(i)&&i.isHook&&(t=i),!(t&&c.isFunction(t)&&t.isHook))return console.log("[HTMLElement]",e,s),n.apply(this,arguments);t(arguments,this).then((t=>(arguments[s.length-1]=void 0,console.log("[HTMLElement hooks]",e,s),n.apply(this,arguments))))},o.prototype[e].hooked=!0)},syncHook(e,t){e||((e=(e,t)=>new Promise(((o,n)=>{!0!==t.sync&&"true"!==t.sync||d.syncAttr(t,e),o()}))).isHook=!0),d.hooks("attributeChangedCallback",e,t)},syncAttr(e,t){const o=t[0],n=t[1],s=t[2];if(e.shadowRoot.childNodes.length>0){let t=e.shadowRoot.childNodes;for(let e=0;e<t.length;e++){let e=t[0];s?e.setAttribute(o,s):e.toggleAttribute(o)}console.log("[HTMLElement syncAttr]",o,n,s)}},loadFont(e,t,o){let n=document.getElementsByTagName("head")[0],s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href="/simple-web/font/iconfont.css",n.appendChild(s);let r=document.createElement("script");r.src="/simple-web/font/iconfont.js",n.appendChild(r),console.log("loadFont")}};class h extends d.HTMLElement{constructor(){super()}get size(){return this.getAttribute("size")}set size(e){this.setAttribute("size",e)}toggleDisabled(e){this.syncChild=!0,e&&(e.isHook=!0),this.toggleAttribute("disabled",e)}}class p extends h{element;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML='<button class="button" part="button" id="button">\n                                    <slot></slot>\n                                </button>',this.element=e.getElementById("button")}static get observedAttributes(){return["disabled","size"]}attributeChangedCallback(e,t,o){}}class u extends h{element;constructor(e){super();const t=this.attachShadow({mode:"open"});t.innerHTML='<div class="icon iconfont" part="icon" id="icon">\n                                    <slot></slot>\n                                </div>';document.createElement("span").setAttribute("class","icon"),this.element=t.getElementById("icon")}static get observedAttributes(){return["disabled","size","name"]}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}get name(){this.getAttribute("name")}set name(e){this.setAttribute("name",e)}attributeChangedCallback(e,t,o){if(["name"].includes(e)){let e=document.createElement("svg");e.setAttribute("class","icon"),e.setAttribute("aria-hidden","true");let t=document.createElement("use");t.setAttribute("href",`#icon-${o}`),e.append(t),this.removeChild("shadowRoot"),this.prepend(e)}}}let g={button:{constructor:p,isHTMLTag:!0},icon:{constructor:u}};for(let e in g)g.hasOwnProperty(e)&&(d.init(g[e].constructor),customElements.get("s-"+e)||(console.log("s-"+e),customElements.define("s-"+e,g[e].constructor)));d.loadFont();var y={Button:p,Icon:u};module.exports=y;