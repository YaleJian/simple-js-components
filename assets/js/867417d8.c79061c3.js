"use strict";(self.webpackChunksimple_web_components=self.webpackChunksimple_web_components||[]).push([[87],{5952:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var o=n(5349);o.default.init();class s extends o.default.Extends{element;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML='<button class="button" part="button" id="button">\n                                    <slot></slot>\n                                </button>',this.element=e.getElementById("button")}}customElements.get("s-button")||customElements.define("s-button",s)},1074:(e,t,n)=>{n.r(t),n.d(t,{button:()=>o.default});var o=n(5952)},5349:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o={isArray:e=>Array.isArray(e),isObject:e=>"[object Object]"===Object.prototype.toString.call(e),isPromise:e=>"[object Promise]"===Object.prototype.toString.call(e),isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};const s={getType:e=>null==e?String(e):Object.prototype.toString.call(e).match(/\[object (\w+)]/)[1].toLowerCase(),clone:e=>JSON.parse(JSON.stringify(e)),merge(...e){let t,n,i,r,a,l,c=e[0]||{},d=1,u=e.length;for(1===u&&(c=this,d=0);d<u;d++)if(t=e[d],t)for(n in t)r=t[n],"_proto_"!==n&&c[n]!==r&&(r&&(o.isObject(r)||(a=o.isArray(r)))?(i=c[n],l=a&&!o.isArray(i)?[]:a||o.isObject(i)?i:{},a=!1,c[n]=s.merge(l,r)):void 0!==r&&(c[n]=r));return c}};window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("config")}catch(o){window.Event=function(e,t,n,o){let s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t,n,o),s}}let i={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r="readystatechange loadstart progress abort error load timeout loadend".split(" "),a="timeout withCredentials".split(" "),l="readyState responseURL status statusText responseType response responseText responseXML".split(" "),c={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function d(){this.config={events:{},headers:{}},this.proxy=!1,this.debug=!1}s.merge(d,i),s.merge(d.prototype,i),d.prototype.mock=!0,d.prototype.noProxy=!1,s.merge(d.prototype,{open:function(e,t,n,o,i){let c=this;function u(e){for(let t=0;t<l.length;t++)try{c[l[t]]=xhr[l[t]]}catch(e){}c.dispatchEvent(new Event(e.type))}if(s.merge(this.config,{method:e,url:t,async:"boolean"!=typeof n||n,username:o,password:i,body:"",options:{url:t,method:e}}),this.noProxy||this.proxy){let s=function(){let e=function(){let e=location.href,t=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/.exec(e.toLowerCase())||[];return/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(t[1])}();return window.ActiveXObject?!e&&t()||function(){try{return new window._ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}():t();function t(){try{return new window._XMLHttpRequest}catch(e){}}}();this.config.xhr=s;for(let e=0;e<r.length;e++)s.addEventListener(r[e],u);o?s.open(e,t,n,o,i):s.open(e,t,n);for(let t=0;t<a.length;t++)try{s[a[t]]=c[a[t]]}catch(e){}}else this.readyState=d.OPENED,this.dispatchEvent(new Event("readystatechange"))},setRequestHeader:function(e,t){if(this.noProxy||this.proxy)return void this.config.xhr.setRequestHeader(e,t);let n=this.config.headers;n[e]?n[e]+=","+t:n[e]=t},timeout:0,withCredentials:!1,upload:{},send:function(e){let t=this;if(this.config.body=e,this.config.timeout=this.timeout,this.noProxy||this.proxy)this.config.xhr.send(e);else if(this.setRequestHeader("X-Requested-With","MockXHR"),this.dispatchEvent(new Event("loadstart")),t.readyState=d.HEADERS_RECEIVED,t.dispatchEvent(new Event("readystatechange")),t.readyState=d.LOADING,t.dispatchEvent(new Event("readystatechange")),d.proxy){d.debug&&console.log("[XHR] \u8bf7\u6c42xhr:",t.config);let e=d.proxy(t);o.isPromise(e)&&e.then((e=>{n(e)})).catch((e=>{n(e)}))}else console.warn("[tools-xhr] proxy param is not a Promise");function n(e,n){d.debug&&console.log("[XHR] \u54cd\u5e94data:",e),e.responseHeaders&&(t.responseHeaders=e.responseHeaders),e.response&&(t.response=e.response||""),"string"==typeof e.response&&(t.responseText=e.response),e.responseType&&(t.responseType=e.responseType),e.responseURL&&(t.responseURL=e.responseURL),e.responseXML&&(t.responseXML=e.responseXML),t.status=e.status||200,t.statusText=e.statusText||c[t.status],e.timeout&&(t.timeout=e.timeout),e.withCredentials&&(t.withCredentials=e.withCredentials),t.readyState=d.DONE,t.dispatchEvent(new Event("readystatechange")),t.dispatchEvent(new Event("load")),t.dispatchEvent(new Event("loadend"))}},abort:function(){this.noProxy?this.config.xhr.abort():(this.readyState=d.UNSENT,this.dispatchEvent(new Event("abort",!1,!1,this)),this.dispatchEvent(new Event("error",!1,!1,this)))}}),s.merge(d.prototype,{status:d.UNSENT,statusText:"",getResponseHeader:function(e){return this.noProxy||this.proxy?this.config.xhr.getResponseHeader(e):this.responseHeaders[e.toLowerCase()]},getAllResponseHeaders:function(){if(this.noProxy||this.proxy)return this.config.xhr.getAllResponseHeaders();let e=this.responseHeaders,t="";for(let n in e)e.hasOwnProperty(n)&&(t+=n+": "+e[n]+"\r\n");return t},overrideMimeType:function(){},responseHeaders:{},responseURL:"",responseType:"",response:null,responseText:"",responseXML:null}),s.merge(d.prototype,{addEventListener:function(e,t){let n=this.config.events;n[e]||(n[e]=[]),n[e].push(t)},removeEventListener:function(e,t){let n=this.config.events[e]||[];for(let o=0;o<n.length;o++)n[o]===t&&n.splice(o--,1)},dispatchEvent:function(e){let t=this.config.events[e.type]||[];for(let o=0;o<t.length;o++)t[o].call(this,e);let n="on"+e.type;this[n]&&this[n](e)}});let u={debug:!1,requestHook:!1,responseHook:!1,createHooks(){if(XMLHttpRequest.prototype.hooked)console.warn("[XHR Hook]","createHooks only need to create it once");else{let e=XMLHttpRequest.prototype.open,t=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(){let n=arguments,o={};return this.send=function(e){let s=u.requestHook;if(s){if(o={url:n[1],method:n[0],body:arguments[0],headers:this.getAllResponseHeaders()},"function"==typeof s){let{url:e,method:t,body:i,headers:r}=s(o);n[0]=t,n[1]=e,arguments[0]=i;for(let n in r)r.hasOwnProperty(n)&&this.setRequestHeader(n,r[n])}u.debug&&console.log("[XHR Hook] requestHook",o)}return t.apply(this,arguments)},this.addEventListener("readystatechange",(()=>{if(4===this.readyState){let e=this.responseText,t=this.response;Object.defineProperty(this,"responseText",{writable:!0}),Object.defineProperty(this,"response",{writable:!0}),this.responseText=e,this.response=t;let n=u.responseHook;n&&("function"==typeof n&&n(o,this),u.debug&&console.log("[XHR Hook] responseHook",o,this))}}),!1),e.apply(this,[].slice.call(arguments))},XMLHttpRequest.prototype.hooked=!0}}};const p={xhr:{mock:d,hook:u},object:s,compare:o,calculate:{}};class h extends HTMLElement{childNodes;static get observedAttributes(){return["disabled"]}constructor(){super()}attributeChangedCallback(e,t,n){}syncChild=!0;toggleDisabled(e){this.syncChild=!0,e&&(e.isHook=!0),this.toggleAttribute("disabled",e)}}let g={init:()=>{g.hooks("toggleAttribute"),g.syncHook()},hooks(e,t){if(!h.prototype[e].hooked){const n=h.prototype[e];h.prototype[e]=function(){for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];let r=!!(s&&s.length>0)&&s[s.length-1];if(r&&p.compare.isFunction(r)&&r.isHook&&(t=r),!(t&&p.compare.isFunction(t)&&t.isHook))return console.log("[HTMLElement]",e,s),n.apply(this,arguments);t(arguments,this).then((e=>(arguments[s.length-1]=void 0,n.apply(this,arguments))))},h.prototype[e].hooked=!0}},syncHook(e){e||(e=(e,t)=>{const n=e[0],o=e[1],s=e[2];return new Promise(((e,i)=>{g.syncAttr(t,n,o,s),e()}))}),e.isHook=!0,g.hooks("attributeChangedCallback",e)},syncAttr(e,t,n,o){if(e.shadowRoot.childNodes.length>0&&e.syncChild){const s=e.shadowRoot.childNodes[0];n&&o?s[t]=o:s.toggleAttribute(t),console.log("[HTMLElement syncAttr]",t,n,o)}}};const m={Extends:h,...g}},1247:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>d,toc:()=>p});var o=n(7462),s=(n(7294),n(3905)),i=n(8024),r=n(412);const a='import stools from "simple-js-tools"\n\n//HTMLElement\u6269\u5c55\u65b9\u6cd5\nclass HTMLElementExtends extends HTMLElement {\n    childNodes;//\u771f\u5b9e\u7684\u5143\u7d20\n\n    static get observedAttributes() {\n        return [\n            "disabled",\n        ];\n    }\n\n    //\u6784\u9020\u51fd\u6570\n    constructor() {\n        super();\n        // const shadowRoot = this.attachShadow({mode: "open"});\n        // this.element = this.shadowRoot.childNodes\n    }\n\n    attributeChangedCallback(name, oldValue, newValue) {\n        // console.log("attributeChangedCallback",name, oldValue, newValue)\n    }\n\n    syncChild = true //\u662f\u5426\u540c\u6b65\u5c5e\u6027\u53d8\u66f4\u5230\u5b50\u5143\u7d20\n\n    toggleDisabled(callback) {\n\n        //\u5f00\u542f\u540c\u6b65\u5c5e\u6027\u5230\u5b50\u5143\u7d20\n        this.syncChild = true\n\n        if (callback) callback.isHook = true\n        this.toggleAttribute("disabled", callback)\n    }\n\n}\n\nlet func = {\n    init: () => {\n\n        //\u5e03\u5c14\u503c\u5c5e\u6027\u7684\u72b6\u6001\uff08\u5982\u679c\u5c5e\u6027\u4e0d\u5b58\u5728\u5219\u6dfb\u52a0\u5c5e\u6027\uff0c\u5c5e\u6027\u5b58\u5728\u5219\u79fb\u9664\u5c5e\u6027\uff09\n        func.hooks("toggleAttribute")\n\n        // \u540c\u6b65\u81ea\u5b9a\u4e49\u5143\u7d20\u5c5e\u6027\u5230shadowRoot\u5143\u7d20\n        func.syncHook()\n\n    },\n\n    //\u52ab\u6301HTMLElement\u6240\u6709\u65b9\u6cd5\n    hooks(functionName, callback) {\n        if (!HTMLElementExtends.prototype[functionName].hooked) {\n            const raw_func = HTMLElementExtends.prototype[functionName]\n            // if(functionName === "setAttribute") console.log(raw_func,1)\n            HTMLElementExtends.prototype[functionName] = function (...args) {\n                let lastParam = (args && args.length > 0) ? args[args.length - 1] : false\n                if (lastParam && stools.compare.isFunction(lastParam) && lastParam.isHook) callback = lastParam\n                if (callback && stools.compare.isFunction(callback) && callback.isHook) {\n                    callback(arguments, this).then(res => {\n                        arguments[args.length - 1] = undefined\n                        // console.log("[HTMLElement hooks]", functionName, args)\n                        return raw_func.apply(this, arguments)\n                    })\n                } else {\n                    console.log("[HTMLElement]", functionName, args)\n                    return raw_func.apply(this, arguments)\n                }\n            }\n\n            HTMLElementExtends.prototype[functionName].hooked = true\n        }\n    },\n\n    syncHook(callback) {\n        if (!callback) {\n            callback = (args, _this) => {\n                const name = args[0], oldValue = args[1], newValue = args[2]\n                return new Promise((resolve, reject) => {\n                    // console.log("attributeChangedCallback Hook!!", args, _this.syncChild, _this)\n                    func.syncAttr(_this, name, oldValue, newValue)\n                    resolve()\n                })\n            }\n        }\n        callback.isHook = true\n        func.hooks("attributeChangedCallback", callback)\n    },\n\n    syncAttr(_this, name, oldValue, newValue) {\n        if (_this.shadowRoot.childNodes.length > 0 && _this.syncChild) {\n            const el = _this.shadowRoot.childNodes[0]\n            if (oldValue && newValue) {\n                el[name] = newValue\n            } else {\n                el.toggleAttribute(name)\n            }\n            console.log("[HTMLElement syncAttr]", name, oldValue, newValue)\n        }\n    }\n}\nexport default {\n    Extends: HTMLElementExtends,\n    ...func\n}',l={},c="\u57fa\u7840",d={unversionedId:"API/\u57fa\u7840/\u57fa\u7840",id:"API/\u57fa\u7840/\u57fa\u7840",title:"\u57fa\u7840",description:"\u6240\u6709\u7ec4\u4ef6\u90fd\u7ee7\u627f\u7684\u529f\u80fd\u3002",source:"@site/document/API/\u57fa\u7840/\u57fa\u7840.mdx",sourceDirName:"API/\u57fa\u7840",slug:"/API/\u57fa\u7840/",permalink:"/simple-web-components/docs/API/\u57fa\u7840/",draft:!1,editUrl:"https://github.com/YaleJian/simple-web-components/document/API/\u57fa\u7840/\u57fa\u7840.mdx",tags:[],version:"current",frontMatter:{},sidebar:"apiSidebar",previous:{title:"\u57fa\u7840",permalink:"/simple-web-components/docs/category/\u57fa\u7840"},next:{title:"\u6309\u94ae",permalink:"/simple-web-components/docs/category/\u6309\u94ae"}},u={};r.Z.canUseDOM&&(n(1074),n(5349));const p=[{value:"\u5185\u7f6e\u65b9\u6cd5Hooks",id:"\u5185\u7f6e\u65b9\u6cd5hooks",level:2},{value:"\u65b9\u6cd5\u8981\u6c42",id:"\u65b9\u6cd5\u8981\u6c42",level:3},{value:"\u540c\u6b65\u5c5e\u6027 SyncAttributes",id:"\u540c\u6b65\u5c5e\u6027-syncattributes",level:2},{value:"\u7981\u7528\u5c5e\u6027 Disabled",id:"\u7981\u7528\u5c5e\u6027-disabled",level:2},{value:"\u8bbe\u7f6e\u7981\u7528\u5c5e\u6027",id:"\u8bbe\u7f6e\u7981\u7528\u5c5e\u6027",level:2},{value:"\u5207\u6362\u7981\u7528\u5c5e\u6027 toggleDisabled",id:"\u5207\u6362\u7981\u7528\u5c5e\u6027-toggledisabled",level:2},{value:"\u6e90\u7801\u5b9e\u73b0",id:"\u6e90\u7801\u5b9e\u73b0",level:2}],h={toc:p},g="wrapper";function m(e){let{components:t,...n}=e;return(0,s.kt)(g,(0,o.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"\u57fa\u7840"},"\u57fa\u7840"),(0,s.kt)("p",null,"\u6240\u6709\u7ec4\u4ef6\u90fd\u7ee7\u627f\u7684\u529f\u80fd\u3002"),(0,s.kt)("h2",{id:"\u5185\u7f6e\u65b9\u6cd5hooks"},"\u5185\u7f6e\u65b9\u6cd5Hooks"),(0,s.kt)("p",null,"\u52ab\u6301\u6240\u6709\u539f\u751f\u65b9\u6cd5\uff0c\u5728\u6267\u884c\u5185\u7f6e\u65b9\u6cd5\u524d\u5148\u6267\u884c\u81ea\u5b9a\u4e49\u65b9\u6cd5\u3002"),(0,s.kt)("h3",{id:"\u65b9\u6cd5\u8981\u6c42"},"\u65b9\u6cd5\u8981\u6c42"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e\u65b9\u6cd5\u7684isCallback\u5c5e\u6027\u4e3atrue\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61\u3002")),(0,s.kt)("p",null,"\u4e00\u4e2a\u5207\u6362\u7981\u7528\u5c5e\u6027\u7684\u4f8b\u5b50\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},'\n//\u786e\u5b9ahook\u7684\u65b9\u6cd5\nHTMLElementExtends.hooks("toggleAttribute")\n\n//\u8bbe\u7f6ehook\u65b9\u6cd5\ntoggleDisabled(callback) {\n    if (callback) callback.isHook = true\n    this.disabled = this.toggleAttribute("disabled", callback)\n}\n\n')),(0,s.kt)("h2",{id:"\u540c\u6b65\u5c5e\u6027-syncattributes"},"\u540c\u6b65\u5c5e\u6027 SyncAttributes"),(0,s.kt)("p",null,"\u540c\u6b65\u81ea\u5b9a\u4e49\u5143\u7d20\u5c5e\u6027\u53d8\u66f4\u5230shadowRoot\u5185\u90e8\u5143\u7d20\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"this.syncChild = true\n")),(0,s.kt)("h2",{id:"\u7981\u7528\u5c5e\u6027-disabled"},"\u7981\u7528\u5c5e\u6027 Disabled"),(0,s.kt)("h2",{id:"\u8bbe\u7f6e\u7981\u7528\u5c5e\u6027"},"\u8bbe\u7f6e\u7981\u7528\u5c5e\u6027"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live",live:!0},"<div>\n    <s-button disabled>\u7981\u7528</s-button>\n</div>\n")),(0,s.kt)("h2",{id:"\u5207\u6362\u7981\u7528\u5c5e\u6027-toggledisabled"},"\u5207\u6362\u7981\u7528\u5c5e\u6027 toggleDisabled"),(0,s.kt)("p",null,"\u5143\u7d20\u9ed8\u8ba4\u7ed1\u5b9a\u4e86toggleDisabled\u65b9\u6cd5\uff0c\u65b9\u6cd5\u9700\u8981\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live",live:!0},'<div>\n    <button onClick={()=>{\n        document.getElementById("toggleDisabledBtn").toggleDisabled(()=>{\n                return new Promise((resolve, reject)=>{\n                    console.log("toggleDisabled\u6267\u884c\u4e86\u81ea\u5b9a\u4e49\u51fd\u6570");\n                    resolve();\n                })\n            })\n        }}\n    >\u70b9\u51fb\u5207\u6362\u7981\u7528\u5c5e\u6027</button>\n\n    <div>\n        <s-button id={"toggleDisabledBtn"}>s-button\u6309\u94ae</s-button>\n    </div>\n</div>\n')),(0,s.kt)("h2",{id:"\u6e90\u7801\u5b9e\u73b0"},"\u6e90\u7801\u5b9e\u73b0"),(0,s.kt)(i.Z,{language:"jsx",mdxType:"CodeBlock"},a))}m.isMDXComponent=!0}}]);